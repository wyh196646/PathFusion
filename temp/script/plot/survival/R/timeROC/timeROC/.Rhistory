library(survival)
library(survminer)
library(writexl)
setwd("C:\\Users\\yanrui\\Desktop\\timeROC")
select_by_p = read.csv("C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.csv")
head(select_by_p)
select_by_p$Risk <- ifelse(select_by_p$risk_score_scale>median(select_by_p$risk_score_scale),"High","Low")
head(select_by_p)
write_xlsx(select_by_p,"C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.xlsx")
fit <- survfit(Surv(survival_time_day, censor_state) ~ select_by_p$Risk, data = select_by_p)
dsurvplot <- ggsurvplot_list(fit,data = select_by_p,pval = T,##是否添加P值
conf.int = F,### 是否添加置信区间
risk.table = T, # 是否添加风险表
risk.table.col = "strata",
###linetype = "strata",
surv.median.line = "hv", # 是否添加中位生存线
risk.table.y.text.col = F,risk.table.y.text = T,
legend.labs = c("High", "Low"),
ggtheme = theme_bw()+theme(legend.text = element_text(colour = c("red", "blue")))
+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())
+theme(plot.title = element_text(hjust = 0.5,size = 12,face = "bold"),axis.title.y.left = element_text(size = 16,face = "bold",vjust = 1),axis.title.x.bottom = element_text(size = 16,face = "bold",vjust = 0))
+theme(axis.text.x.bottom = element_text(size = 12,face = "bold",vjust = -0.8,colour = "black"))
+theme(axis.text.y.left = element_text(size = 12,face = "bold",vjust = 0.5,hjust = 0.5,angle = 90,colour = "black"))
+theme(legend.title = element_text(face = "bold",family = "Times",colour = "black",size = 12))
+theme(legend.text = element_text(face = "bold",family = "Times",colour = "black",size =12)), # Change ggplot2 theme
palette = c("red", "blue"),##如果数据分为两组，就写两种颜色，三组就写三种颜色，具体的颜色搭配参考上一期发布的R语言颜色对比表; c("#bc1e5d", "#0176bd")
xlim=c(10,5000),##x轴的阈值，根据随访数据的天数进行更改
xlab = "Days")##随访的时间时天，就写Days，月份就写Months
dsurvplot
head(select_by_p)
select_by_p$Risk <- ifelse(select_by_p$risk_score_scale>median(select_by_p$risk_score_scale),"High","Low")
library(timeROC)
library(survival)
ROC <- timeROC(T=select_by_p$survival_time_day,
delta=select_by_p$censor_state,
marker=select_by_p$risk_score_scale,
cause=1,                #阳性结局指标数值
weighting="marginal",   #计算方法，默认为marginal
times=c(365, 365*3, 365*5),       #时间点，选取1年，3年和5年的生存率
iid=TRUE)
pdf(file='ROC_final.pdf',height=6,width=8, family='Times')
plot(ROC,
time=365, col="red", lwd=2, title = "")   #time是时间点，col是线条颜色
plot(ROC,
time=365*3, col="blue", add=TRUE, lwd=2)    #add指是否添加在上一张图中
plot(ROC,
time=365*5, col="orange", add=TRUE, lwd=2)
setwd("C:\\Users\\yanrui\\Desktop\\timeROC")
select_by_p = read.csv("C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.csv")
head(select_by_p)
select_by_p = read.csv("C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.csv")
head(select_by_p)
select_by_p$Risk <- ifelse(select_by_p$risk_score_scale>median(select_by_p$risk_score_scale),"High","Low")
head(select_by_p)
write_xlsx(select_by_p,"C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.xlsx")
fit <- survfit(Surv(survival_time_day, censor_state) ~ select_by_p$Risk, data = select_by_p)
setwd("C:\\Users\\yanrui\\Desktop\\timeROC")
select_by_p = read.csv("C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.csv")
head(select_by_p)
select_by_p$Risk <- ifelse(select_by_p$risk_score_scale>median(select_by_p$risk_score_scale),"High","Low")
fit <- survfit(Surv(survival_time_day, censor_state) ~ select_by_p$Risk, data = select_by_p)
dsurvplot <- ggsurvplot_list(fit,data = select_by_p,pval = T,##是否添加P值
conf.int = F,### 是否添加置信区间
risk.table = T, # 是否添加风险表
risk.table.col = "strata",
###linetype = "strata",
surv.median.line = "hv", # 是否添加中位生存线
risk.table.y.text.col = F,risk.table.y.text = T,
legend.labs = c("High", "Low"),
ggtheme = theme_bw()+theme(legend.text = element_text(colour = c("red", "blue")))
+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())
+theme(plot.title = element_text(hjust = 0.5,size = 12,face = "bold"),axis.title.y.left = element_text(size = 16,face = "bold",vjust = 1),axis.title.x.bottom = element_text(size = 16,face = "bold",vjust = 0))
+theme(axis.text.x.bottom = element_text(size = 12,face = "bold",vjust = -0.8,colour = "black"))
+theme(axis.text.y.left = element_text(size = 12,face = "bold",vjust = 0.5,hjust = 0.5,angle = 90,colour = "black"))
+theme(legend.title = element_text(face = "bold",family = "Times",colour = "black",size = 12))
+theme(legend.text = element_text(face = "bold",family = "Times",colour = "black",size =12)), # Change ggplot2 theme
palette = c("red", "blue"),##如果数据分为两组，就写两种颜色，三组就写三种颜色，具体的颜色搭配参考上一期发布的R语言颜色对比表; c("#bc1e5d", "#0176bd")
xlim=c(10,5000),##x轴的阈值，根据随访数据的天数进行更改
xlab = "Days")##随访的时间时天，就写Days，月份就写Months
dsurvplot
library(timeROC)
library(survival)
ROC <- timeROC(T=select_by_p$survival_time_day,
delta=select_by_p$censor_state,
marker=select_by_p$risk_score_scale,
cause=1,                #阳性结局指标数值
weighting="marginal",   #计算方法，默认为marginal
times=c(365, 365*3, 365*5),       #时间点，选取1年，3年和5年的生存率
iid=TRUE)
pdf(file='ROC_final.pdf',height=6,width=8, family='Times')
plot(ROC,
time=365, col="red", lwd=2, title = "")   #time是时间点，col是线条颜色
plot(ROC,
time=365*3, col="blue", add=TRUE, lwd=2)    #add指是否添加在上一张图中
plot(ROC,
time=365*5, col="orange", add=TRUE, lwd=2)
#添加标签信息
legend("bottomright",
c(paste0("AUC at 1 year: ",round(ROC[["AUC"]][1],3)),
paste0("AUC at 3 year: ",round(ROC[["AUC"]][2],3)),
paste0("AUC at 5 year: ",round(ROC[["AUC"]][3],3))),
col=c("red", "blue", "orange"),
lty=1, lwd=2,bty = "n")
head(select_by_p)
setwd("C:\\Users\\yanrui\\Desktop\\timeROC")
select_by_p = read.csv("C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.csv")
head(select_by_p)
library(timeROC)
library(survival)
ROC <- timeROC(T=select_by_p$survival_time_day,
delta=select_by_p$censor_state,
marker=select_by_p$risk_score_scale,
cause=1,                #阳性结局指标数值
weighting="marginal",   #计算方法，默认为marginal
times=c(365, 365*3, 365*5),       #时间点，选取1年，3年和5年的生存率
iid=TRUE)
pdf(file='ROC_final.pdf',height=6,width=8, family='Times')
plot(ROC,
time=365, col="red", lwd=2, title = "")   #time是时间点，col是线条颜色
plot(ROC,
time=365*3, col="blue", add=TRUE, lwd=2)    #add指是否添加在上一张图中
plot(ROC,
time=365*5, col="orange", add=TRUE, lwd=2)
#添加标签信息
legend("bottomright",
c(paste0("AUC at 1 year: ",round(ROC[["AUC"]][1],3)),
paste0("AUC at 3 year: ",round(ROC[["AUC"]][2],3)),
paste0("AUC at 5 year: ",round(ROC[["AUC"]][3],3))),
col=c("red", "blue", "orange"),
lty=1, lwd=2,bty = "n")
dev.off()#关闭PDF
select_by_p = read.csv("C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.csv")
head(select_by_p)
select_by_p$Risk <- ifelse(select_by_p$risk_score_scale>median(select_by_p$risk_score_scale),"High","Low")
head(select_by_p)
write_xlsx(select_by_p,"C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.xlsx")
fit <- survfit(Surv(survival_time_day, censor_state) ~ select_by_p$Risk, data = select_by_p)
dsurvplot <- ggsurvplot_list(fit,data = select_by_p,pval = T,##是否添加P值
conf.int = F,### 是否添加置信区间
risk.table = T, # 是否添加风险表
risk.table.col = "strata",
###linetype = "strata",
surv.median.line = "hv", # 是否添加中位生存线
risk.table.y.text.col = F,risk.table.y.text = T,
legend.labs = c("High", "Low"),
ggtheme = theme_bw()+theme(legend.text = element_text(colour = c("red", "blue")))
+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())
+theme(plot.title = element_text(hjust = 0.5,size = 12,face = "bold"),axis.title.y.left = element_text(size = 16,face = "bold",vjust = 1),axis.title.x.bottom = element_text(size = 16,face = "bold",vjust = 0))
+theme(axis.text.x.bottom = element_text(size = 12,face = "bold",vjust = -0.8,colour = "black"))
+theme(axis.text.y.left = element_text(size = 12,face = "bold",vjust = 0.5,hjust = 0.5,angle = 90,colour = "black"))
+theme(legend.title = element_text(face = "bold",family = "Times",colour = "black",size = 12))
+theme(legend.text = element_text(face = "bold",family = "Times",colour = "black",size =12)), # Change ggplot2 theme
palette = c("red", "blue"),##如果数据分为两组，就写两种颜色，三组就写三种颜色，具体的颜色搭配参考上一期发布的R语言颜色对比表; c("#bc1e5d", "#0176bd")
xlim=c(10,5000),##x轴的阈值，根据随访数据的天数进行更改
xlab = "Days")##随访的时间时天，就写Days，月份就写Months
dsurvplot
library(timeROC)
library(survival)
ROC <- timeROC(T=select_by_p$survival_time_day,
delta=select_by_p$censor_state,
marker=select_by_p$risk_score_scale,
cause=1,                #阳性结局指标数值
weighting="marginal",   #计算方法，默认为marginal
times=c(365, 365*3, 365*5),       #时间点，选取1年，3年和5年的生存率
iid=TRUE)
pdf(file='ROC_final.pdf',height=6,width=8, family='Times')
plot(ROC,
time=365, col="red", lwd=2, title = "")   #time是时间点，col是线条颜色
plot(ROC,
time=365*3, col="blue", add=TRUE, lwd=2)    #add指是否添加在上一张图中
plot(ROC,
time=365*5, col="orange", add=TRUE, lwd=2)
#添加标签信息
legend("bottomright",
c(paste0("AUC at 1 year: ",round(ROC[["AUC"]][1],3)),
paste0("AUC at 3 year: ",round(ROC[["AUC"]][2],3)),
paste0("AUC at 5 year: ",round(ROC[["AUC"]][3],3))),
col=c("red", "blue", "orange"),
lty=1, lwd=2,bty = "n")
dev.off()#关闭PDF
library(survival)
library(survminer)
library(writexl)
setwd("C:\\Users\\yanrui\\Desktop\\timeROC")
select_by_p = read.csv("C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.csv")
head(select_by_p)
select_by_p$Risk <- ifelse(select_by_p$risk_score_scale>median(select_by_p$risk_score_scale),"High","Low")
head(select_by_p)
library(timeROC)
library(survival)
ROC <- timeROC(T=select_by_p$survival_time_day,
delta=select_by_p$censor_state,
marker=select_by_p$risk_score_scale,
cause=1,                #阳性结局指标数值
weighting="marginal",   #计算方法，默认为marginal
times=c(365, 365*3, 365*5),       #时间点，选取1年，3年和5年的生存率
iid=TRUE)
pdf(file='ROC_final.pdf',height=6,width=8, family='Times')
plot(ROC,
time=365, col="red", lwd=2, title = "")   #time是时间点，col是线条颜色
plot(ROC,
time=365*3, col="blue", add=TRUE, lwd=2)    #add指是否添加在上一张图中
plot(ROC,
time=365*5, col="orange", add=TRUE, lwd=2)
#添加标签信息
legend("bottomright",
c(paste0("AUC at 1 year: ",round(ROC[["AUC"]][1],3)),
paste0("AUC at 3 year: ",round(ROC[["AUC"]][2],3)),
paste0("AUC at 5 year: ",round(ROC[["AUC"]][3],3))),
col=c("red", "blue", "orange"),
lty=1, lwd=2,bty = "n")
dev.off()#关闭PDF
setwd("C:\\Users\\yanrui\\Desktop\\timeROC")
select_by_p = read.csv("C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.csv")
head(select_by_p)
library(timeROC)
library(survival)
ROC <- timeROC(T=select_by_p$survival_time_day,
delta=select_by_p$censor_state,
marker=select_by_p$risk_score_scale,
cause=1,                #阳性结局指标数值
weighting="marginal",   #计算方法，默认为marginal
times=c(365, 365*3, 365*5),       #时间点，选取1年，3年和5年的生存率
iid=TRUE)
pdf(file='timeROC.pdf',height=6,width=8, family='Times')
plot(ROC,
time=365, col="red", lwd=2, title = "")   #time是时间点，col是线条颜色
plot(ROC,
time=365*3, col="blue", add=TRUE, lwd=2)    #add指是否添加在上一张图中
plot(ROC,
time=365*5, col="orange", add=TRUE, lwd=2)
#添加标签信息
legend("bottomright",
c(paste0("AUC at 1 year: ",round(ROC[["AUC"]][1],3)),
paste0("AUC at 3 year: ",round(ROC[["AUC"]][2],3)),
paste0("AUC at 5 year: ",round(ROC[["AUC"]][3],3))),
col=c("red", "blue", "orange"),
lty=1, lwd=2,bty = "n")
dev.off()#关闭PDF
select_by_p$Risk <- ifelse(select_by_p$risk_score_scale>median(select_by_p$risk_score_scale),"High","Low")
head(select_by_p)
write_xlsx(select_by_p,"C:\\Users\\yanrui\\Desktop\\timeROC\\select_by_p.xlsx")
fit <- survfit(Surv(survival_time_day, censor_state) ~ select_by_p$Risk, data = select_by_p)
dsurvplot <- ggsurvplot_list(fit,data = select_by_p,pval = T,##是否添加P值
conf.int = F,### 是否添加置信区间
risk.table = T, # 是否添加风险表
risk.table.col = "strata",
###linetype = "strata",
surv.median.line = "hv", # 是否添加中位生存线
risk.table.y.text.col = F,risk.table.y.text = T,
legend.labs = c("High", "Low"),
ggtheme = theme_bw()+theme(legend.text = element_text(colour = c("red", "blue")))
+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank())
+theme(plot.title = element_text(hjust = 0.5,size = 12,face = "bold"),axis.title.y.left = element_text(size = 16,face = "bold",vjust = 1),axis.title.x.bottom = element_text(size = 16,face = "bold",vjust = 0))
+theme(axis.text.x.bottom = element_text(size = 12,face = "bold",vjust = -0.8,colour = "black"))
+theme(axis.text.y.left = element_text(size = 12,face = "bold",vjust = 0.5,hjust = 0.5,angle = 90,colour = "black"))
+theme(legend.title = element_text(face = "bold",family = "Times",colour = "black",size = 12))
+theme(legend.text = element_text(face = "bold",family = "Times",colour = "black",size =12)), # Change ggplot2 theme
palette = c("red", "blue"),##如果数据分为两组，就写两种颜色，三组就写三种颜色，具体的颜色搭配参考上一期发布的R语言颜色对比表; c("#bc1e5d", "#0176bd")
xlim=c(10,5000),##x轴的阈值，根据随访数据的天数进行更改
xlab = "Days")##随访的时间时天，就写Days，月份就写Months
dsurvplot
library(survival)
library(survminer)
library(writexl)
library(timeROC)
library(timeROC)
library(survival)
setwd("C:\\Users\\yanrui\\Desktop\\timeROC")
select_by_p = read.csv("C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.csv")
head(select_by_p)
ROC <- timeROC(T=select_by_p$survival_time_day,
delta=select_by_p$censor_state,
marker=select_by_p$risk_score_scale,
cause=1,                #阳性结局指标数值
weighting="marginal",   #计算方法，默认为marginal
times=c(365, 365*3, 365*5),       #时间点，选取1年，3年和5年的生存率
iid=TRUE)
pdf(file='timeROC.pdf',height=6,width=8, family='Times')
plot(ROC,
time=365, col="red", lwd=2, title = "")   #time是时间点，col是线条颜色
plot(ROC,
time=365*3, col="blue", add=TRUE, lwd=2)    #add指是否添加在上一张图中
plot(ROC,
time=365*5, col="orange", add=TRUE, lwd=2)
#添加标签信息
legend("bottomright",
c(paste0("AUC at 1 year: ",round(ROC[["AUC"]][1],3)),
paste0("AUC at 3 year: ",round(ROC[["AUC"]][2],3)),
paste0("AUC at 5 year: ",round(ROC[["AUC"]][3],3))),
col=c("red", "blue", "orange"),
lty=1, lwd=2,bty = "n")
dev.off()#关闭PDF
library(timeROC)
library(survival)
setwd("C:\\Users\\yanrui\\Desktop\\timeROC")
select_by_p = read.csv("C:\\Users\\yanrui\\Desktop\\timeROC\\final_blca.csv")
head(select_by_p)
ROC <- timeROC(T=select_by_p$survival_time_day,
delta=select_by_p$censor_state,
marker=select_by_p$risk_score_scale,
cause=1,                #阳性结局指标数值
weighting="marginal",   #计算方法，默认为marginal
times=c(365, 365*3, 365*5),       #时间点，选取1年，3年和5年的生存率
iid=TRUE)
pdf(file='timeROC.pdf',height=6,width=8, family='Times')
plot(ROC,
time=365, col="red", lwd=2, title = "")   #time是时间点，col是线条颜色
plot(ROC,
time=365*3, col="blue", add=TRUE, lwd=2)    #add指是否添加在上一张图中
plot(ROC,
time=365*5, col="orange", add=TRUE, lwd=2)
#添加标签信息
legend("bottomright",
c(paste0("AUC at 1 year: ",round(ROC[["AUC"]][1],3)),
paste0("AUC at 3 year: ",round(ROC[["AUC"]][2],3)),
paste0("AUC at 5 year: ",round(ROC[["AUC"]][3],3))),
col=c("red", "blue", "orange"),
lty=1, lwd=2,bty = "n")
dev.off()#关闭PDF
